;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; Written by : - Ziad Sherif  13-12-2021                                              ;;
; parameters : - array of reg names, array of corresponding offsets                   ;;
;                register name, destination,flag                                      ;;
; return     : - destination offset and a flag => 1 means not found else not affected ;;
;A macro that fills registersOffsets array with offsets of registers array            ;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
validateRegister MACRO Names,offsets,reg,destination,flag                             ;;                                                  
    LOCAL mainLoop                                                                    ;;          
    LOCAL found                                                                       ;;      
    LOCAL NotFirst                                                                    ;;          
    LOCAL notFound                                                                    ;;          
    LOCAL exit_vr                                                                        ;;
                                                                                      ;;
    mov cx,30   ;;iterate on on 30 byte of Names==> ax bx ..dh dl                     ;;
                                                                                      ;;
    mainLoop:                                                                         ;;
                                                                                      ;;
        mov bx,cx                                                                     ;;
        mov ax,Names[bx]   ;;get the register with index bx from end to begin         ;;
        cmp ax,reg         ;;compare with input register                              ;;
        jz found                                                                      ;;
                                                                                      ;;
        dec cx     ;dec cx by 2 ==>1 word                                             ;;
    loop mainLoop                                                                     ;;
                                                                                      ;;
                                                                                      ;;
    found:                                                                            ;;
    mov ax,Names  ;ax points to the first reg ('ax')                                  ;;
    cmp ax,reg                                                                        ;;
                                                                                      ;;
    jnz NotFirst                                                                      ;;
                                                                                      ;;
                                                                                      ;;
        mov ax,word ptr offsets   ;get first word of offset array                     ;;
        mov destination,ax                                                            ;;
        jmp exit_vr                                                                      ;;
                                                                                      ;;
                                                                                      ;;
    NotFirst:                                                                         ;;
    mov ax,0    ;check if reach to the  beggining of array or not                     ;;
    cmp cx,ax                                                                         ;;
    jz notFound                                                                       ;;
                                                                                      ;;
                                                                                      ;;
        mov bx,cx          ;;founded                                                  ;;
        mov ax,word ptr offsets[bx]                                                   ;;
        mov destination,ax                                                            ;;
        jmp exit_vr                                                                      ;;
                                                                                      ;;
    notFound:                                                                         ;;
        mov flag,1  ;;set flag to 1 which indicates isNot Found                       ;;
                                                                                      ;;
    exit_vr:                                                                             ;;
ENDM                                                                                  ;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;