;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; Written by : - Abdelrahman Hamza  12-12-2021                                        ;;
; parameters : - a number represented as a string you want to validate                ;;
; return     : - flag = 1 if not valid memory else not affect it                      ;;
;A macro that validate a number => has spaces and 0,1,...f                            ;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
validateMemory MACRO string,flag,destination                                          ;;
    LOCAL GoToStringEnd                                                               ;;
    LOCAL compareEnd                                                                  ;;
    LOCAL notValidSquare                                                              ;;
    LOCAL WithSquareBracktes                                                          ;;
    LOCAL noSqaure                                                                    ;;
    LOCAL done                                                                        ;;
    PUSHALL                                                                           ;;
    mov bx,offset string                                                              ;;
    removeSpaces bx                                                                   ;;
    POPALL                                                                            ;;
    mov bx,offset string                                                              ;;
    mov si,offset string                                                              ;;
                                                                                      ;;
    GoToStringEnd:                                                                    ;;
        mov ah,'$'                                                                    ;;
        cmp [si],ah                                                                   ;;
        inc si                                                                        ;;
        mov ah,'$'                                                                    ;;
        cmp [si],ah                                                                   ;;
    jnz GoToStringEnd                                                                 ;;
    dec si                                                                            ;;
                                                                                      ;;
    mov ah,'['                                                                        ;;
    cmp [bx],ah                                                                       ;;
    jnz compareEnd                                                                    ;;
        mov ah,']'                                                                    ;;
        cmp [si],ah                                                                   ;;
        jnz notValidSquare                                                            ;;
        jmp WithSquareBracktes                                                        ;;
        compareEnd:                                                                   ;;
        mov ah,']'                                                                    ;;
        cmp [si],ah                                                                   ;;
        jz notValidSquare                                                             ;;
        jmp noSqaure                                                                  ;;
    notValidSquare: mov flag,0001h                                                    ;;
    jmp done                                                                          ;;
    WithSquareBracktes:                                                               ;;
    inc bx                                                                            ;;
    mov ah,'$'                                                                        ;;
    mov [si],ah                                                                       ;;
    PUSHALL                                                                           ;;
    validateNumbers bx,flag                                                           ;;
    POPALL                                                                            ;;
    jmp done                                                                          ;;
    noSqaure:                                                                         ;;
    PUSHALL                                                                           ;;
    validateNumbers bx,flag                                                           ;;
    POPALL                                                                            ;;
    done:                                                                             ;;
    mov destination,bx                                                                ;;
ENDM                                                                                  ;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;