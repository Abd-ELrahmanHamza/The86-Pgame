;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; Written by : - Abdelrahman Hamza  12-12-2021                                        ;;
; parameters : - two arrays 1) input array 2) output array                            ;;
; return     : - fill output array with offsets of input array                        ;;
;A macro that fills registersOffsets array with offsets of registers array            ;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
offsetSetter MACRO InputRegisters, InputRegistersOffsets                              ;;
    LOCAL offsetLoop16                                                                ;;
    LOCAL offsetLoop8                                                                 ;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    ; loop 16 times => number of registers                                            ;;
    ;set offsets of 16bit registers                                                   ;;
    mov cx,16                                                                         ;;
     ; Loop start                                                                     ;;
     offsetLoop16:                                                                    ;;
        mov bx,cx                                                                     ;;
        mov ax,offset InputRegisters                                                  ;;
        add ax,cx                                                                     ;;
        mov InputRegistersOffsets[bx],ax                                              ;;
        dec cx                                                                        ;;
     loop offsetLoop16                                                                ;;
                                                                                      ;;
    ;next two line Handels first 16bit register                                       ;;
    mov ax,offset InputRegisters                                                      ;;
    mov InputRegistersOffsets,ax                                                      ;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
    ;set offsets of 8bit registers                                                    ;;
    ; cx only handels loop range                                                      ;;
    mov cx,16                                                                         ;;
    ; bx iterates over offsetArray                                                    ;;
    mov bx,16                                                                         ;;
    ; si iterates over registers                                                      ;;
    mov si,0                                                                          ;;
    ; Loop start                                                                      ;;
     offsetLoop8:                                                                     ;;
        mov ax,offset InputRegisters                                                  ;;
        add ax,si                                                                     ;;
        mov InputRegistersOffsets[bx],ax                                              ;;
        inc si                                                                        ;;
        add bx,2                                                                      ;;
        dec cx                                                                        ;;
     loop offsetLoop8                                                                 ;;
ENDM                                                                                  ;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;