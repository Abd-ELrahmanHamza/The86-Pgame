;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; Written by : - Abdelrahman Hamza  12-12-2021                                        ;;
; parameters : - a number represented as a string you want to validate                ;;
; return     : - flag = 1 if not valid memory else not affect it                      ;;
;A macro that validate a number => has spaces and 0,1,...f                            ;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
validateMemorySrc MACRO string,flag,source,typeOfSource                                         ;;
    LOCAL GoToStringEnd                                                               ;;
    LOCAL compareEnd                                                                  ;;
    LOCAL notValidSquare                                                              ;;
    LOCAL WithSquareBracktes                                                          ;;
    LOCAL noSqaure                                                                    ;;
    LOCAL exitVmemSrc                                                                        ;;
    PUSHALL                                                                           ;;
    mov di,offset string                                                              ;;
    removeSpaces di                                                                   ;;
    POPALL                                                                            ;;
    mov di,offset string                                                              ;;
    mov si,offset string                                                              ;;
                                                                                      ;;
    GoToStringEnd:                                                                    ;;
        mov ah,'$'                                                                    ;;
        cmp [si],ah                                                                   ;;
        inc si                                                                        ;;
        mov ah,'$'                                                                    ;;
        cmp [si],ah                                                                   ;;
    jnz GoToStringEnd                                                                 ;;
    dec si                                                                            ;;
                                                                                      ;;
    mov ah,'['                                                                        ;;
    cmp [di],ah                                                                       ;;
    jnz compareEnd                                                                    ;;
        mov ah,']'                                                                    ;;
        cmp [si],ah                                                                   ;;
        jnz notValidSquare                                                            ;;
        jmp WithSquareBracktes                                                        ;;
        compareEnd:                                                                   ;;
        mov ah,']'                                                                    ;;
        cmp [si],ah                                                                   ;;
        jz notValidSquare                                                             ;;
        jmp noSqaure                                                                  ;;
    notValidSquare: mov flag,0001h                                                    ;;
    jmp exitVmemSrc                                                                          ;;
    WithSquareBracktes:                                                               ;;
    mov typeOfSource,01h
    inc di                                                                            ;;
    mov ah,'$'                                                                        ;;
    mov [si],ah                                                                       ;;
    PUSHALL                                                                           ;;
    validateNumbers di,flag                                                           ;;
    POPALL                                                                            ;;
    jmp exitVmemSrc                                                                          ;;
    noSqaure:                                                                         ;;
    mov typeOfSource,02h
    PUSHALL                                                                           ;;
    validateNumbers di,flag                                                           ;;
    POPALL                                                                            ;;
    exitVmemSrc:                                                                             ;;
    mov source,di                                                                ;;
ENDM                                                                                  ;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;